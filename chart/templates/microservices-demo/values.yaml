{{- if .Values.microservicesDemo.enabled }}
{{- include "values-secret" (dict "root" $ "package" .Values.microservicesDemo "name" "microservices-demo" "defaults" (include "dorkomen.defaults.microservicesDemo" .)) }}
{{- end }}

{{- define "dorkomen.defaults.microservicesDemo" -}}
# Online Boutique (microservices-demo) default values
{{- $domainName := default .Values.domain .Values.hostname }}

# Global image settings
{{- if (include "imagePullSecret" .) }}
imagePullSecrets:
  - name: private-registry
{{- end }}

# Frontend service configuration
# Disable external LoadBalancer service to avoid timeout issues in local environments
frontend:
  externalService: false
  cymbalBranding: false

# Default resource configurations for all services
# These can be overridden in values.yaml
default:
  resources:
    requests:
      cpu: 100m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi

# Service-specific configurations
cartService:
  resources:
    requests:
      cpu: 200m
      memory: 64Mi
    limits:
      cpu: 300m
      memory: 128Mi

checkoutService:
  resources:
    requests:
      cpu: 100m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi

currencyService:
  resources:
    requests:
      cpu: 100m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi

emailService:
  resources:
    requests:
      cpu: 100m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi

paymentService:
  resources:
    requests:
      cpu: 100m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi

productCatalogService:
  resources:
    requests:
      cpu: 100m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi

recommendationService:
  resources:
    requests:
      cpu: 100m
      memory: 220Mi
    limits:
      cpu: 200m
      memory: 450Mi

shippingService:
  resources:
    requests:
      cpu: 100m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi

adService:
  resources:
    requests:
      cpu: 200m
      memory: 180Mi
    limits:
      cpu: 300m
      memory: 300Mi

# Network policies (disabled by default, enable if needed)
networkPolicies:
  create: false

{{- end -}}
